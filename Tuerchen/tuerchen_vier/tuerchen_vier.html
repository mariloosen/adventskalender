<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>T√ºrchen 4 - Puzzle</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
<style>
.inter {
  font-family: "Inter", sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
}
body {
  text-align: center;
  font-family: Inter, monospace;
  font-weight: 400;
}
h1 {
  font-weight: 900;
}
#puzzle {
  display: grid;
  grid-template-columns: repeat(4, 100px);
  grid-gap: 2px;
  width: 408px; /* 4*100 + 3*2 */
  margin: 20px auto;
}
.piece {
  width: 100px;
  height: 100px;
  background-image: url('img/beispiel_puzzle_bild.jpg');
  background-size: 400px 400px; /* Gesamtbildgr√∂√üe */
  cursor: pointer;
  border: 1px solid #ccc;
}
</style>
</head>
<body>
  <main>
    <h1>T√ºrchen 4 - Puzzle</h1>
    <div id="puzzle"></div>
    <p id="message" style="font-weight:bold;"></p>
  </main>

<script>
const puzzle = document.getElementById("puzzle");
const message = document.getElementById("message");
const size = 4; // 4x4 Puzzle

// Puzzle-Teile erstellen
let pieces = [];
for(let y=0; y<size; y++){
  for(let x=0; x<size; x++){
    const div = document.createElement("div");
    div.className = "piece";
    div.style.backgroundPosition = `-${x*100}px -${y*100}px`;
    div.dataset.x = x;
    div.dataset.y = y;
    div.draggable = true;
    pieces.push(div);
  }
}

// Shuffle-Funktion
function shuffle(array) {
  for (let i = array.length -1; i>0; i--){
    const j = Math.floor(Math.random() * (i+1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

pieces = shuffle(pieces);
pieces.forEach(p => puzzle.appendChild(p));

// Drag & Drop
let dragged;
pieces.forEach(p => {
  p.addEventListener('dragstart', e => dragged = e.target);
  p.addEventListener('dragover', e => e.preventDefault());
  p.addEventListener('drop', e => {
    if(dragged !== e.target){
      const parent = e.target.parentNode;
      const temp = document.createElement('div');
      parent.replaceChild(temp, dragged);
      parent.replaceChild(dragged, e.target);
      parent.replaceChild(e.target, temp);
      checkWin();
    }
  });
});

// Pr√ºfen, ob Puzzle korrekt
function checkWin(){
  const children = Array.from(puzzle.children);
  for(let i=0; i<children.length; i++){
    const x = i % size;
    const y = Math.floor(i / size);
    if(children[i].dataset.x != x || children[i].dataset.y != y){
      message.textContent = "";
      return;
    }
  }
  message.textContent = "Geschafft! Kuss von Mari üíñ";
}
</script>
</body>
</html>
